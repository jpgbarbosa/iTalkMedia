/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-html5",function(e,t){function a(){a.superclass.constructor.apply(this,arguments)}var n=e.HistoryBase,r=e.Lang,i=e.config.win,s=e.config.useHistoryHTML5,o="popstate",u=n.SRC_REPLACE;e.extend(a,n,{_init:function(t){var n=i.history.state;e.Object.isEmpty(n)&&(n=null),t||(t={}),t.initialState&&r.type(t.initialState)==="object"&&r.type(n)==="object"?this._initialState=e.merge(t.initialState,n):this._initialState=n,e.on("popstate",this._onPopState,i,this),a.superclass._init.apply(this,arguments)},_storeState:function(t,n,r){t!==o&&i.history[t===u?"replaceState":"pushState"](n,r.title||e.config.doc.title||"",r.url||null),a.superclass._storeState.apply(this,arguments)},_onPopState:function(e){this._resolveChanges(o,e._event.state||null)}},{NAME:"historyhtml5",SRC_POPSTATE:o}),e.Node.DOM_EVENTS.popstate||(e.Node.DOM_EVENTS.popstate=1),e.HistoryHTML5=a;if(s===!0||s!==!1&&n.html5)e.History=a},"3.7.3",{optional:["json"],requires:["event-base","history-base","node-base"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-hash",function(e,t){function p(){p.superclass.constructor.apply(this,arguments)}var n=e.HistoryBase,r=e.Lang,i=e.Array,s=e.Object,o=YUI.namespace("Env.HistoryHash"),u="hash",a,f,l,c=e.config.win,h=e.config.useHistoryHTML5;e.extend(p,n,{_init:function(t){var n=p.parseHash();t=t||{},this._initialState=t.initialState?e.merge(t.initialState,n):n,e.after("hashchange",e.bind(this._afterHashChange,this),c),p.superclass._init.apply(this,arguments)},_change:function(e,t,n){return s.each(t,function(e,n){r.isValue(e)&&(t[n]=e.toString())}),p.superclass._change.call(this,e,t,n)},_storeState:function(e,t){var r=p.decode,i=p.createHash(t);p.superclass._storeState.apply(this,arguments),e!==u&&r(p.getHash())!==r(i)&&p[e===n.SRC_REPLACE?"replaceHash":"setHash"](i)},_afterHashChange:function(e){this._resolveChanges(u,p.parseHash(e.newHash),{})}},{NAME:"historyHash",SRC_HASH:u,hashPrefix:"",_REGEX_HASH:/([^\?#&]+)=([^&]+)/g,createHash:function(e){var t=p.encode,n=[];return s.each(e,function(e,i){r.isValue(e)&&n.push(t(i)+"="+t(e))}),n.join("&")},decode:function(e){return decodeURIComponent(e.replace(/\+/g," "))},encode:function(e){return encodeURIComponent(e).replace(/%20/g,"+")},getHash:e.UA.gecko?function(){var t=e.getLocation(),n=/#(.*)$/.exec(t.href),r=n&&n[1]||"",i=p.hashPrefix;return i&&r.indexOf(i)===0?r.replace(i,""):r}:function(){var t=e.getLocation(),n=t.hash.substring(1),r=p.hashPrefix;return r&&n.indexOf(r)===0?n.replace(r,""):n},getUrl:function(){return location.href},parseHash:function(e){var t=p.decode,n,i,s,o,u={},a=p.hashPrefix,f;e=r.isValue(e)?e:p.getHash();if(a){f=e.indexOf(a);if(f===0||f===1&&e.charAt(0)==="#")e=e.replace(a,"")}s=e.match(p._REGEX_HASH)||[];for(n=0,i=s.length;n<i;++n)o=s[n].split("="),u[t(o[0])]=t(o[1]);return u},replaceHash:function(t){var n=e.getLocation(),r=n.href.replace(/#.*$/,"");t.charAt(0)==="#"&&(t=t.substring(1)),n.replace(r+"#"+(p.hashPrefix||"")+t)},setHash:function(t){var n=e.getLocation();t.charAt(0)==="#"&&(t=t.substring(1)),n.hash=(p.hashPrefix||"")+t}}),a=o._notifiers,a||(a=o._notifiers=[]),e.Event.define("hashchange",{on:function(t,n,r){(t.compareTo(c)||t.compareTo(e.config.doc.body))&&a.push(r)},detach:function(e,t,n){var r=i.indexOf(a,n);r!==-1&&a.splice(r,1)}}),f=p.getHash(),l=p.getUrl(),n.nativeHashChange?o._hashHandle||(o._hashHandle=e.Event.attach("hashchange",function(e){var t=p.getHash(),n=p.getUrl();i.each(a.concat(),function(r){r.fire({_event:e,oldHash:f,oldUrl:l,newHash:t,newUrl:n})}),f=t,l=n},c)):o._hashPoll||(o._hashPoll=e.later(50,null,function(){var e=p.getHash(),t,n;f!==e&&(n=p.getUrl(),t={oldHash:f,oldUrl:l,newHash:e,newUrl:n},f=e,l=n,i.each(a.concat(),function(e){e.fire(t)}))},null,!0)),e.HistoryHash=p;if(h===!1||!e.History&&h!==!0&&(!n.html5||!e.HistoryHTML5))e.History=p},"3.7.3",{requires:["event-synthetic","history-base","yui-later"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("history-hash-ie",function(e,t){if(e.UA.ie&&!e.HistoryBase.nativeHashChange){var n=e.Do,r=YUI.namespace("Env.HistoryHash"),i=e.HistoryHash,s=r._iframe,o=e.config.win;i.getIframeHash=function(){if(!s||!s.contentWindow)return"";var e=i.hashPrefix,t=s.contentWindow.location.hash.substr(1);return e&&t.indexOf(e)===0?t.replace(e,""):t},i._updateIframe=function(e,t){var n=s&&s.contentWindow&&s.contentWindow.document,r=n&&n.location;if(!n||!r)return;t?r.replace(e.charAt(0)==="#"?e:"#"+e):(n.open().close(),r.hash=e)},n.before(i._updateIframe,i,"replaceHash",i,!0),s||e.on("domready",function(){var t=i.getHash();s=r._iframe=e.Node.getDOMNode(e.Node.create('<iframe src="javascript:0" style="display:none" height="0" width="0" tabindex="-1" title="empty"/>')),e.config.doc.documentElement.appendChild(s),i._updateIframe(t||"#"),e.on("hashchange",function(e){t=e.newHash,i.getIframeHash()!==t&&i._updateIframe(t)},o),e.later(50,null,function(){var e=i.getIframeHash();e!==t&&i.setHash(e)},null,!0)})}},"3.7.3",{requires:["history-hash","node-base"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("router",function(e,t){function l(){l.superclass.constructor.apply(this,arguments)}var n=e.HistoryHash,r=e.QueryString,i=e.Array,s=e.Lang,o=e.config.win,u=[],a=[],f="ready";e.Router=e.extend(l,e.Base,{_regexPathParam:/([:*])([\w\-]+)?/g,_regexUrlQuery:/\?([^#]*).*$/,_regexUrlOrigin:/^(?:[^\/#?:]+:\/\/|\/\/)[^\/]*/,initializer:function(t){var n=this;n._html5=n.get("html5"),n._routes=[],n._url=n._getURL(),n._setRoutes(t&&t.routes?t.routes:n.get("routes")),n._html5?(n._history=new e.HistoryHTML5({force:!0}),n._historyEvents=e.after("history:change",n._afterHistoryChange,n)):n._historyEvents=e.on("hashchange",n._afterHistoryChange,o,n),n.publish(f,{defaultFn:n._defReadyFn,fireOnce:!0,preventable:!1}),n.once("initializedChange",function(){e.once("load",function(){setTimeout(function(){n.fire(f,{dispatched:!!n._dispatched})},20)})}),u.push(this)},destructor:function(){var e=i.indexOf(u,this);e>-1&&u.splice(e,1),this._historyEvents&&this._historyEvents.detach()},dispatch:function(){return this.once(f,function(){this._ready=!0;if(this._html5&&this.upgrade())return;this._dispatch(this._getPath(),this._getURL())}),this},getPath:function(){return this._getPath()},hasRoute:function(e){var t;return this._hasSameOrigin(e)?(this._html5||(e=this._upgradeURL(e)),t=this.removeQuery(this.removeRoot(e)),!!this.match(t).length):!1},match:function(e){return i.filter(this._routes,function(t){return e.search(t.regex)>-1})},removeRoot:function(e){var t=this.get("root");return e=e.replace(this._regexUrlOrigin,""),t&&e.indexOf(t)===0&&(e=e.substring(t.length)),e.charAt(0)==="/"?e:"/"+e},removeQuery:function(e){return e.replace(/\?.*$/,"")},replace:function(e){return this._queue(e,!0)},route:function(e,t){t=i.flatten(i(arguments,1,!0));var n=[];return this._routes.push({callbacks:t,keys:n,path:e,regex:this._getRegex(e,n),callback:t[0]}),this},save:function(e){return this._queue(e)},upgrade:function(){if(!this._html5)return!1;var e=this._getHashPath();return e?(this.once(f,function(){this.replace(e)}),!0):!1},_decode:function(e){return decodeURIComponent(e.replace(/\+/g," "))},_dequeue:function(){var t=this,n;return YUI.Env.windowLoaded?(n=a.shift(),n?n():this):(e.once("load",function(){t._dequeue()}),this)},_dispatch:function(t,n,r){var s=this,o=s.match(t),u=[],a,f,l;return s._dispatching=s._dispatched=!0,!o||!o.length?(s._dispatching=!1,s):(f=s._getRequest(t,n,r),l=s._getResponse(f),f.next=function(n){var r,c;if(n)n==="route"?(u=[],f.next()):e.error(n);else if(r=u.shift())typeof r=="string"&&(r=s[r]),f.pendingCallbacks=u.length,r.call(s,f,l,f.next);else if(c=o.shift())u=c.callbacks.concat(),a=c.regex.exec(t),a.length===c.keys.length+1?f.params=i.hash(c.keys,a.slice(1)):f.params=a.concat(),f.pendingRoutes=o.length,f.next()},f.next(),s._dispatching=!1,s._dequeue())},_getHashPath:function(e){return e||(e=n.getHash()),e&&e.charAt(0)==="/"?this._joinURL(e):""},_getOrigin:function(){var t=e.getLocation();return t.origin||t.protocol+"//"+t.host},_getPath:function(){var t=!this._html5&&this._getHashPath()||e.getLocation().pathname;return this.removeQuery(this.removeRoot(t))},_getPathRoot:function(){var t="/",n=e.getLocation().pathname,r;return n.charAt(n.length-1)===t?n:(r=n.split(t),r.pop(),r.join(t)+t)},_getQuery:function(){var t=e.getLocation(),r,i;return this._html5?t.search.substring(1):(r=n.getHash(),i=r.match(this._regexUrlQuery),r&&i?i[1]:t.search.substring(1))},_getRegex:function(e,t){return e instanceof RegExp?e:e==="*"?/.*/:(e=e.replace(this._regexPathParam,function(e,n,r){return r?(t.push(r),n==="*"?"(.*?)":"([^/#?]*)"):n==="*"?".*":e}),new RegExp("^"+e+"$"))},_getRequest:function(e,t,n){return{path:e,query:this._parseQuery(this._getQuery()),url:t,src:n}},_getResponse:function(e){var t=function(){return e.next.apply(this,arguments)};return t.req=e,t},_getRoutes:function(){return this._routes.concat()},_getURL:function(){var t=e.getLocation().toString();return this._html5||(t=this._upgradeURL(t)),t},_hasSameOrigin:function(t){var n=(t&&t.match(this._regexUrlOrigin)||[])[0];return n&&n.indexOf("//")===0&&(n=e.getLocation().protocol+n),!n||n===this._getOrigin()},_joinURL:function(e){var t=this.get("root");return e=this.removeRoot(e),e.charAt(0)==="/"&&(e=e.substring(1)),t&&t.charAt(t.length-1)==="/"?t+e:t+"/"+e},_normalizePath:function(e){var t="..",n="/",r,i,s,o,u,a;if(!e||e===n)return n;o=e.split(n),a=[];for(r=0,i=o.length;r<i;++r)u=o[r],u===t?a.pop():u&&a.push(u);return s=n+a.join(n),s!==n&&e.charAt(e.length-1)===n&&(s+=n),s},_parseQuery:r&&r.parse?r.parse:function(e){var t=this._decode,n=e.split("&"),r=0,i=n.length,s={},o;for(;r<i;++r)o=n[r].split("="),o[0]&&(s[t(o[0])]=t(o[1]||""));return s},_queue:function(){var t=arguments,n=this;return a.push(function(){return n._html5?e.UA.ios&&e.UA.ios<5?n._save.apply(n,t):setTimeout(function(){n._save.apply(n,t)},1):(n._dispatching=!0,n._save.apply(n,t)),n}),this._dispatching?this:this._dequeue()},_resolvePath:function(t){return t?(t.charAt(0)!=="/"&&(t=this._getPathRoot()+t),this._normalizePath(t)):e.getLocation().pathname},_resolveURL:function(t){var n=t&&t.match(this._regexURL),r,i,s,o,u;return n?(r=n[1],i=n[2],s=n[3],o=n[4],r?(r.indexOf("//")===0&&(r=e.getLocation().protocol+r),r+(i||"/")+(s||"")+(o||"")):(u=this._getOrigin()+this._resolvePath(i),i||s?u+(s||"")+(o||""):(s=this._getQuery(),u+(s?"?"+s:"")+(o||"")))):e.getLocation().toString()},_save:function(t,r){var i=typeof t=="string",s,o;if(i&&!this._hasSameOrigin(t))return e.error("Security error: The new URL must be of the same origin as the current URL."),this;i&&(t=this._joinURL(t)),this._ready=!0;if(this._html5)this._history[r?"replace":"add"](null,{url:t});else{s=e.getLocation().pathname,o=this.get("root");if(o===s||o===this._getPathRoot())t=this.removeRoot(t);t===n.getHash()?e.Router.dispatch():n[r?"replaceHash":"setHash"](t)}return this},_setRoutes:function(e){return this._routes=[],i.each(e,function(e){var t=e.callbacks||e.callback;this.route(e.path,t)},this),this._routes.concat()},_upgradeURL:function(t){if(!this._hasSameOrigin(t))return t;var n=(t.match(/#(.*)$/)||[])[1]||"",r=e.HistoryHash.hashPrefix,i;return r&&n.indexOf(r)===0&&(n=n.replace(r,"")),n&&(i=this._getHashPath(n)),i?this._resolveURL(i):t},_afterHistoryChange:function(e){var t=this,n=e.src,r=t._url,i=t._getURL();t._url=i;if(n==="popstate"&&(!t._ready||r.replace(/#.*$/,"")===i.replace(/#.*$/,"")))return;t._dispatch(t._getPath(),i,n)},_defReadyFn:function(e){this._ready=!0}},{NAME:"router",ATTRS:{html5:{valueFn:function(){return e.Router.html5},writeOnce:"initOnly"},root:{value:""},routes:{value:[],getter:"_getRoutes",setter:"_setRoutes"}},html5:e.HistoryBase.html5&&(!e.UA.android||e.UA.android>=3),_instances:u,dispatch:function(){var e,t,n;for(e=0,t=u.length;e<t;e+=1)n=u[e],n&&n._dispatch(n._getPath(),n._getURL())}}),e.Controller=e.Router},"3.7.3",{optional:["querystring-parse"],requires:["array-extras","base-build","history"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("pjax-base",function(e,t){function s(){}var n=e.config.win,r=e.ClassNameManager.getClassName("pjax"),i="navigate";s.prototype={_regexURL:/^((?:[^\/#?:]+:\/\/|\/\/)[^\/]*)?([^?#]*)(\?[^#]*)?(#.*)?$/,initializer:function(){this.publish(i,{defaultFn:this._defNavigateFn}),this.get("html5")&&this._pjaxBindUI()},destructor:function(){this._pjaxEvents&&this._pjaxEvents.detach()},navigate:function(t,n){return t=this._resolveURL(t),this._navigate(t,n)?!0:(this._hasSameOrigin(t)||e.error("Security error: The new URL must be of the same origin as the current URL."),!1)},_isLinkSameOrigin:function(t){var n=e.getLocation(),r=n.protocol,i=n.hostname,s=parseInt(n.port,10)||null,o;return t.get("protocol")!==r||t.get("hostname")!==i?!1:(o=parseInt(t.get("port"),10)||null,r==="http:"?(s||(s=80),o||(o=80)):r==="https:"&&(s||(s=443),o||(o=443)),o===s)},_navigate:function(t,r){t=this._upgradeURL(t);if(!this.hasRoute(t))return!1;r=e.merge(r,{url:t});var s=this._getURL(),o,u;u=t.replace(/(#.*)$/,function(e,t,n){return o=t,e.substring(n)});if(o&&u===s.replace(/#.*$/,"")){if(!this.get("navigateOnHash"))return!1;r.hash=o}return"replace"in r||(r.replace=t===s),this.get("html5")||r.force?this.fire(i,r):r.replace?n&&n.location.replace(t):n&&(n.location=t),!0},_pjaxBindUI:function(){this._pjaxEvents||(this._pjaxEvents=e.one("body").delegate("click",this._onLinkClick,this.get("linkSelector"),this))},_defNavigateFn:function(e){this[e.replace?"replace":"save"](e.url),n&&this.get("scrollToTop")&&setTimeout(function(){n.scroll(0,0)},1)},_onLinkClick:function(e){var t,n;if(e.button!==1||e.ctrlKey||e.metaKey)return;t=e.currentTarget;if(t.get("tagName").toUpperCase()!=="A")return;if(!this._isLinkSameOrigin(t))return;n=t.get("href"),n&&this._navigate(n,{originEvent:e})&&e.preventDefault()}},s.ATTRS={linkSelector:{value:"a."+r,writeOnce:"initOnly"},navigateOnHash:{value:!1},scrollToTop:{value:!0}},e.PjaxBase=s},"3.7.3",{requires:["classnamemanager","node-event-delegate","router"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("view",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}e.View=e.extend(n,e.Base,{containerTemplate:"<div/>",events:{},template:"",_allowAdHocAttrs:!0,initializer:function(t){t||(t={}),t.containerTemplate&&(this.containerTemplate=t.containerTemplate),t.template&&(this.template=t.template),this.events=t.events?e.merge(this.events,t.events):this.events,this.after("containerChange",this._afterContainerChange)},destroy:function(e){return e&&(e.remove||e["delete"])&&this.onceAfter("destroy",function(){this._destroyContainer()}),n.superclass.destroy.call(this)},destructor:function(){this.detachEvents(),delete this._container},attachEvents:function(t){var n=this.get("container"),r=e.Object.owns,i,s,o,u;this.detachEvents(),t||(t=this.events);for(u in t){if(!r(t,u))continue;s=t[u];for(o in s){if(!r(s,o))continue;i=s[o],typeof i=="string"&&(i=this[i]);if(!i)continue;this._attachedViewEvents.push(n.delegate(o,i,u,this))}}return this},create:function(t){return t?e.one(t):e.Node.create(this.containerTemplate)},detachEvents:function(){return e.Array.each(this._attachedViewEvents,function(e){e&&e.detach()}),this._attachedViewEvents=[],this},remove:function(){var e=this.get("container");return e&&e.remove(),this},render:function(){return this},_destroyContainer:function(){var e=this.get("container");e&&e.remove(!0)},_getContainer:function(e){return this._container||(e?(this._container=e,this.attachEvents()):(e=this._container=this.create(),this._set("container",e))),e},_afterContainerChange:function(){this.attachEvents(this.events)}},{NAME:"view",ATTRS:{container:{getter:"_getContainer",setter:e.one,writeOnce:!0}},_NON_ATTRS_CFG:["containerTemplate","events","template"]})},"3.7.3",{requires:["base-build","node-event-delegate"]});
/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("app-base",function(e,t){var n=e.Lang,r=e.Object,i=e.PjaxBase,s=e.Router,o=e.View,u=e.ClassNameManager.getClassName,a=e.config.win,f;f=e.Base.create("app",e.Base,[o,s,i],{views:{},initializer:function(t){function i(t,r){n[r]=e.merge(n[r],t)}t||(t={});var n={};r.each(this.views,i),r.each(t.views,i),this.views=n,this._viewInfoMap={},this.after("activeViewChange",e.bind("_afterActiveViewChange",this)),this.get("serverRouting")||this._pjaxBindUI()},createView:function(t,i){var s=this.getViewInfo(t),u=s&&s.type||o,a,f;return a=n.isString(u)?r.getValue(e,u.split(".")):u,f=new a(i),this._viewInfoMap[e.stamp(f,!0)]=s,f},getViewInfo:function(t){return n.isString(t)?this.views[t]:t&&this._viewInfoMap[e.stamp(t,!0)]},render:function(){var t=e.App.CLASS_NAMES,n=this.get("container"),r=this.get("viewContainer"),i=this.get("activeView"),s=i&&i.get("container"),o=n.compareTo(r);return n.addClass(t.app),r.addClass(t.views),i&&!r.contains(s)&&r.appendChild(s),!n.contains(r)&&!o&&n.appendChild(r),this},showView:function(t,r,i,s){var o,u;return i||(i={}),s?i=e.merge(i,{callback:s}):n.isFunction(i)&&(i={callback:i}),n.isString(t)&&(o=this.getViewInfo(t),o&&o.preserve&&o.instance?(t=o.instance,this._viewInfoMap[e.stamp(t,!0)]=o):(t=this.createView(t,r),u=!0)),i.update&&!u&&t.setAttrs(r),"render"in i?i.render&&t.render():u&&t.render(),this._set("activeView",t,{options:i})},_attachView:function(e,t){if(!e)return;var n=this.getViewInfo(e),r=this.get("viewContainer");e.addTarget(this),n&&(n.instance=e),r[t?"prepend":"append"](e.get("container"))},_destroyContainer:function(){var t=e.App.CLASS_NAMES,n=this.get("container"),r=this.get("viewContainer"),i=n.compareTo(r);if(e.one("body").compareTo(n)){this.detachEvents(),n.removeClass(t.app),i?n.removeClass(t.views):r.remove(!0);return}r.remove(!0),i||n.remove(!0)},_detachView:function(t){if(!t)return;var n=this.getViewInfo(t)||{};n.preserve?t.remove():(t.destroy({remove:!0}),delete this._viewInfoMap[e.stamp(t,!0)],t===n.instance&&delete n.instance),t.removeTarget(this)},_getViewContainer:function(e){return!e&&!this._viewContainer&&(e=this._viewContainer=this.create(),this._set("viewContainer",e)),e},_initHtml5:function(){return this.get("serverRouting")===!1?!1:s.html5},_isChildView:function(e,t){var n=this.getViewInfo(e),r=this.getViewInfo(t);return n&&r?this.getViewInfo(n.parent)===r:!1},_isParentView:function(e,t){var n=this.getViewInfo(e),r=this.getViewInfo(t);return n&&r?this.getViewInfo(r.parent)===n:!1},_navigate:function(t,n){return this.get("serverRouting")||(n=e.merge({force:!0},n)),i.prototype._navigate.call(this,t,n)},_save:function(t,n){var r;return this.get("serverRouting")&&!this.get("html5")?this._hasSameOrigin(t)?(a&&(r=this._joinURL(t||""),n?a.location.replace(r):a.location=r),this):(e.error("Security error: The new URL must be of the same origin as the current URL."),this):s.prototype._save.apply(this,arguments)},_uiSetActiveView:function(e,t,n){n||(n={});var r=n.callback,i=this._isChildView(e,t),s=!i&&this._isParentView(e,t),o=!!n.prepend||s;if(e===t)return r&&r.call(this,e);this._attachView(e,o),this._detachView(t),r&&r.call(this,e)},_afterActiveViewChange:function(e){this._uiSetActiveView(e.newVal,e.prevVal,e.options)}},{ATTRS:{activeView:{value:null,readOnly:!0},container:{valueFn:function(){return e.one("body")}},html5:{valueFn:"_initHtml5"},linkSelector:{value:"a"},serverRouting:{valueFn:function(){return e.App.serverRouting},writeOnce:"initOnly"},viewContainer:{getter:"_getViewContainer",setter:e.one,writeOnce:!0}},_NON_ATTRS_CFG:["views"]}),e.namespace("App").Base=f,e.App=e.mix(e.Base.create("app",f,[]),e.App,!0),e.App.CLASS_NAMES={app:u("app"),views:u("app","views")}},"3.7.3",{requires:["classnamemanager","pjax-base","router","view"]});
(function(){var a="flickr-app";YUI.add(a,function(g){var f;function e(){if(!f){f=new g.App({serverRouting:true,linkSelector:false,scrollToTop:false});f.upgradeClick=d;f.saveIfRoutable=c;f.replaceIfRoutable=b;g.FlickrApp=f;if(g.config.flickr.user.admin_user==="hartsell"){F.FlickrApp=f}}}function c(h){var i;i=f.removeRoot(h);if(f.hasRoute(i)){f.save(i);return true}return false}function b(h){var i;i=f.removeRoot(h);if(f.hasRoute(i)){f.replace(i);return true}return false}function d(k){var i,h,j;if(k.altKey||k.ctrlKey||k.metaKey||k.shiftKey){return}i=k.target.ancestor("a",true);h=i&&i.getAttribute("href");if(h){j=f.removeRoot(h);if(f.hasRoute(j)){k.preventDefault();f.save(j);return true}}return false}g.FlickrApp={init:e}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("flickr-tooltips",function(a){var q=null,g=null,b=0,k=null,c=null,n=null;function h(){q=document.createElement("div");g=document.createElement("div");q.style.display="none";q.style.zIndex="200000";document.body.appendChild(q);q.appendChild(g)}function m(s,u,v,r,z){var t,B,C,A;s=a.one(s);z=z||"ToolTip";if(!q){h()}if(s.getStyle("visibility")==="hidden"){return}q.className=z;if(b){if(k===s._node){d();return}d()}r=(r===undefined)?"":r;v+=r.length;n=document.getElementById(u);g.innerHTML=n.innerHTML+r;g.style.width="auto";q.style.display="block";q.style.visibility="hidden";if(z!=="ToolTipSmall"){w=150;if(v>200){w=300}else{if(v>100){w=200}}g.style.width=w+"px"}t=q.offsetWidth;C=s.getX();A=s.getY();if(z==="ToolTipSmall"){C-=Math.round((t-s.get("offsetWidth"))/2)-5;if(s._node.tip_placement==="below"){A+=s.get("offsetHeight")+10}else{A-=22}}else{A+=20}B=f()-40;if(C+t>B){C=B-t}C=Math.max(10,C);q.style.left=C+"px";q.style.top=A+"px";b=1;q.style.display="block";q.style.visibility="visible";k=s._node;document.onmousedown=l}function l(s){var r=e(s);if(r===k||(o(r)&&j(r))){document.onmousedown=function(){}}else{d()}}function d(r){if(r){if(k!==r){return}}document.onmousedown=function(){};if(!q){return false}b=0;q.style.display="none";k="null";return false}function j(r){var s=r;while(s){if(s===q){return 1}s=s.parentNode}return 0}function o(r){var s=r;while(s){if(s.href){return 1}s=s.parentNode}return 0}function i(){if(window.innerHeight){return window.innerHeight}else{if(document.documentElement.clientHeight){return document.documentElement.clientHeight}else{if(document.body.clientHeight){return document.body.clientHeight}}}}function f(){if(window.innerWidth){return window.innerWidth}else{if(document.documentElement.clientWidth){return document.documentElement.clientWidth}else{if(document.body.clientWidth){return document.body.clientWidth}}}}function e(r){if(r&&r.target){return r.target}if(r&&r.srcElement){return r.srcElement}if(window.event){return window.event.srcElement}return null}function p(){window.show_tooltip=m}a.tooltips={init:p}},"0.0.1",{requires:["node","event","event-delegate"]});YUI.add("cache-simple",function(a){CacheSimple=function(){};CacheSimple.prototype={cache:{},add:function(b,c,d){this.cache[b]={response:c,payload:d}},retrieve:function(b){return this.cache[b]},clear:function(){this.cache={}}};a.CacheSimple=CacheSimple},"0.0.1");YUI.add("node-visibility",function(b){var o,m,g,k,n,a,p,q,e=window,s=window.document,r;m={resize:[],scroll:[]};r=(F.config.flickr.flags.enable_global_nav&&b.one("#global-nav"))?b.one("#global-nav").get("offsetHeight"):0;function j(t){b.Array.each(m.scroll,function(u){u(t)})}function c(t){b.Array.each(m.resize,function(u){u(t)})}g={register:function(u,v){var t=m[u].push(v);return{detach:function(){m[u][t]=function(){}}}}};b.on("scroll",b.betterThrottle(j,50));b.on("resize",b.betterThrottle(c,50));function i(){var t=i.region;if(!t){t={};t.height=b.DOM.winHeight();t.width=b.DOM.winWidth();t.top=Math.max(s.body.scrollTop||0,s.documentElement.scrollTop||0,e.pageYOffset||0);t.left=Math.max(s.body.scrollLeft||0,s.documentElement.scrollLeft||0,e.pageXOffset||0);t.right=t.left+t.width;t.bottom=t.top+t.height;t[0]=t.top;t[1]=t.left;i.region=t}return t}function d(){i.region=undefined}g.register("resize",d);g.register("scroll",d);function l(u,t){var v={};if(b.Lang.isNumber(t[0])){v.left=u.left-t[0];v.right=u.right+t[0];v.width=u.width+t[0]*2;if(v.width<1){v.width=1;v.left=Math.floor((u.right+u.left)/2);v.right=v.left+1}v[0]=v.top}if(b.Lang.isNumber(t[1])){v.top=u.top-t[1];v.bottom=u.bottom+t[1];v.height=u.height+t[1]*2;if(v.height<1){v.height=1;v.top=Math.floor((u.bottom+u.top)/2);v.bottom=v.top+1}v[1]=v.left}return v}k=function(v,u){var t,w;for(t=v.ancestor();t;t=t.ancestor()){w=t.getStyle("overflow");if(w!==""&&w!=="visible"){u=u||v.get("region");if(!v.inRegion(t,false,u)){return true}}}return false};function f(u){var t,v;if(!f.cache){f.cache=new b.CacheSimple()}t=f.cache;if(b.Lang.isString(u)){v=t.retrieve(u);if(v&&v.response&&(new Date()).getTime()<v.payload.expires){return v.response}else{return null}}else{return t}}function h(t,v){var u=500;if(!b.Lang.isString(t)){return false}f().add(t,v,{expires:(new Date()).getTime()+u});return true}n=function(w,t){var u,z,x,v,y;u=true;t=t?p(t):[0,0];x=w.toString();y=f(x);v=y||{};if(u){if(!b.Lang.isString(v.display)){v.display=w.getStyle("display")}if(!b.Lang.isNumber(v.offsetHeight)){v.offsetHeight=w.get("offsetHeight")}if(!b.Lang.isNumber(v.offsetWidth)){v.offsetWidth=w.get("offsetWidth")}if(v.display==="block"&&(v.offsetHeight===0||v.offsetWidth===0)){u=false}}if(u){z=i();if(!v.region){v.region=w.get("region")}if(!w.inRegion(l(z,t),false,v.region)){u=false}}if(u){if(!b.Lang.isBoolean(v.hidden_by_overflow)){v.hidden_by_overflow=k(w,v.region)}if(v.hidden_by_overflow){u=false}}if(!y){h(x,v)}return u};a=(function(){var t=false,v={},B,u,C,A,x,w,z,y;B=function(){if(!t){z=g.register("scroll",x);y=g.register("resize",x);t=true}};u=function(){if(t){z.detach();y.detach();t=false}};C=function(G){var D,E;if(v[G]){delete v[G];E=true;for(D in v){if(v.hasOwnProperty(D)){E=false;break}}if(E){u()}return true}return undefined};A=function(E){var D=v[E];if(b.Lang.isObject(D)){if(n(D.node,D.threshold)){D.callback.call(D.oScope,D.arg);C(E)}}};x=function(){for(var D in v){if(v.hasOwnProperty(D)){A(D)}}};w=function(G,E,D){if(b.Lang.isObject(v[G])){v[G][E]=D;return true}return undefined};return function(I,K,E,D,G){var H,J;I=b.one(I);if(!b.Lang.isObject(I)||!b.Lang.isFunction(K)){return false}E=E?p(E):[0,0];if(!D){D=I}if(G===true){G=D}if(!b.Lang.isObject(G)){G=window}B();H={node:I,callback:K,threshold:E,arg:D,oScope:G};J=b.guid();v[J]=H;b.later(0,window,A,J);return{cancel:function(){return C(J)},set:function(M,L){return w(J,M,L)},check:function(){return A(J)}}}}());p=function(t){if(b.Lang.isNumber(t)){t=[t,t]}if(!b.Lang.isArray(t)||!b.Lang.isNumber(t[0])||!b.Lang.isNumber(t[1])){t=[0,0]}return t};q=function(u,t,w){var v,x;if(!u instanceof b.Node){return false}if(!u.inViewportRegion(true)){t=!!t;w=b.Lang.isNumber(w)?w:0;e.setTimeout(function(){if(!b.Anim){u.scrollIntoView(t)}else{if(t){x=u.getY()-w}else{x=u.getY()+u.get("offsetHeight")-u.get("winHeight")+5}x-=r;v=new b.Anim({node:b.one("window"),to:{scroll:[0,x]},duration:0.3,easing:b.Easing.easeOut});v.run()}},0)}return u};o=function(t){this._node=t.host};o.NS="vis";o.NAME="NodeVisibilityPlugin";o.prototype={isVisible:function(t){return n(this._node,t)},onVisible:function(w,u,t,v){return a(this._node,w,u,t,v)},animScrollIntoView:function(t,u){return q(this._node,t,u)},destroy:function(){}};b.Node.plug(o)},"0.0.1",{requires:["node","node-pluginhost","better-throttle","cache-simple"],optional:["anim","anim-scroll"]});YUI.add("personmenu-transjax",function(b){var a={svn_bump:"",error_timeout:'Uh oh! There was a problem contacting the server.',error_getting:'Uh oh! There was a problem getting data from the server.'};b.transjax.add("personmenu",a)},"0.0.1",{requires:["transjax-base"]});YUI.add("personmenu-rapid",function(a){a.on("personmenu:show",function(b){if(b){a.rapidTracker.addModules(b)}})},"0.0.1",{requires:F.config.modules["personmenu-rapid"].requires||[]});YUI.add("personmenu",function(c){var u,H,o,y,d,Q,A,x,F,S;function O(U){if(!O.is_init){H={open_on_icon_click:false,get_data_on_arrow_hover:true,show_delay:100,hide_delay:500,spinner_delay:200,io_timeout:10000,io_cache_ttl:120000,zeus:false};if(!c.Lang.isObject(U)){U={}}H=c.mix(U,H);u=c.one("body");if(c.config.flickr.user.nsid||c.config.flickr.flags.enable_grease){u.on("mouseover",b);u.on("mouseout",b);u.on("click",t);c.on("resize",t);c.on("contact_changer:change",L);c.on("contact_changer:open",M);c.on("PageContext:set",g)}O.is_init=true}}function h(V){var U,W;if(!h.cache){h.cache=new c.CacheSimple()}U=h.cache;if(c.Lang.isString(V)){W=U.retrieve(V);if(W&&W.response&&(new Date()).getTime()<W.payload.expires){return W.response}else{return null}}else{return U}}function f(U,V){if(!c.Lang.isString(U)){return false}h().add(U,V,{expires:(new Date()).getTime()+H.io_cache_ttl});return true}function n(U){f(U,null)}function B(U){return(function(){var V;return function(){var Y,Z,X,W;if(!V||arguments.length!==V.length){Y=true}else{X=Array.prototype.slice.call(arguments);W=Array.prototype.slice.call(V);for(Z in X){if(X.hasOwnProperty(Z)){if(X[Z]!==W[Z]){Y=true;break}}}}if(Y){U.apply(this,arguments)}V=arguments}}())}function l(U){if(c.Lang.isString(U)){U=c.one(U)}if(!U instanceof c.Node){return false}return U}function b(U){if(!U.target.hasClass("personmenu-trigger")){return}switch(U.type){case"mouseover":if((d||A)&&Q){return}C(U.target);break;case"mouseout":N();break}}function L(U){n(U.nsid)}function z(U){switch(U.type){case"mouseover":T();if(H.get_data_on_arrow_hover){if(c.one(".personmenu .personmenu-arrow")&&(U.target.test(".personmenu .personmenu-arrow")||c.one(".personmenu .personmenu-arrow").contains(U.target))){if(!d&&!h(o)){P(o)}}}break;case"mouseout":if(!d&&!A){I()}break;case"click":if(c.one(".personmenu .personmenu-arrow")&&(U.target.test(".personmenu .personmenu-arrow")||c.one(".personmenu .personmenu-arrow").contains(U.target))){U.preventDefault();w()}else{if(H.zeus&&(c.one(".personmenu .personmenu-more")&&(U.target.test(".personmenu .personmenu-more")||c.one(".personmenu .personmenu-more").contains(U.target)))){if(!d){U.preventDefault();U.halt();k()}}else{if(H.open_on_icon_click&&c.one(".personmenu .personmenu-icon-link")&&(U.target.test(".personmenu .personmenu-icon-link")||c.one(".personmenu .personmenu-icon-link").contains(U.target))){if(!d){U.preventDefault();k()}}else{if(c.one(".personmenu .personmenu-relationship-change")&&(U.target.test(".personmenu .personmenu-relationship-change")||c.one(".personmenu .personmenu-relationship-change").contains(U.target))){if(c.config.modules["contact-changer"]){U.preventDefault();s()}c.use("contact-changer",function(W){i();W.contact_changer.show(o)})}else{if(c.one(".personmenu .photos-trigger")&&U.target.test(".personmenu .photos-trigger")){var V=U.target.ancestor("li").one(".photos");if(V){U.preventDefault();V.toggleClass("photos-open")}}else{c.fire("personmenu:navigate",{id:p().get("id"),url:U.target.get("href")})}}}}}break}}function t(U){if(U.type==="click"){if(H.open_on_icon_click&&U.target.hasClass("personmenu-trigger")){U.preventDefault();U.halt();k(U.target)}else{if(Q&&!c.one(".personmenu").contains(U.target)){M()}}}if(U.type==="resize"){if(Q){m(y)}}}function g(U){if(U.newVal!==""){M()}}function T(){if(F){window.clearTimeout(F);F=null}}function N(){if(x){window.clearTimeout(x);x=null}}function C(U){T();N();if(Q&&!H.zeus){r(U)}else{x=window.setTimeout(function(){x=null;r(U)},H.show_delay)}}function I(){if(!F){F=window.setTimeout(function(){F=null;M()},H.hide_delay)}}function j(V){var U;V=l(V);U=V.get("data-defer-src")||V.get("src");return U}function R(V){var U;V=l(V);U=a(V);return U?"/photos/"+U:false}function a(W){var V,U;V=j(W);U=V.split("#")[1];return J(U)?U:false}function J(U){return(/^[0-9]+@N[0-9]{2}$/).test(U)}function p(){var U;if(!p.menu){if(H.zeus){U='<div class="personmenu personmenu-hidden personmenu-zeus"><div class="personmenu-hd"><a data-track="icon-link" href="" class="personmenu-icon-link rapidnofollow"><img class="personmenu-icon"></a><span class="personmenu-spinner"></span><span class="personmenu-name"></span></div><div class="personmenu-bd"></div></div>'}else{U='<div class="personmenu personmenu-hidden"><div class="personmenu-hd rapidnofollow"><a data-track="icon-link" href="" class="personmenu-icon-link rapidnofollow"><span class="personmenu-spinner"></span><img class="personmenu-icon"></a><a data-track="show-menu" href="" class="rapidnofollow personmenu-arrow" role="button"><span></span></a></div><span class="personmenu-hd-shadow"></span><div class="personmenu-bd"></div><span class="personmenu-bd-border-blocker"></span></div>'}c.one("body").append(U);p.menu=c.one(".personmenu");p.menu.on("mouseover",z);p.menu.on("mouseout",z);p.menu.on("click",z)}return p.menu}function w(){if(d){r()}else{k()}}function q(U,V){if(U){p().one(".personmenu-icon-link").set("href",U)}if(V){p().one(".personmenu-icon").set("src",V)}}q=B(q);function s(){A=true;p().addClass("personmenu-spinning");if(H.zeus){if(p().one(".personmenu-spinner")){p().one(".personmenu-spinner").addClass("personmenu-spinner-on")}}else{S=window.setTimeout(function(){p().one(".personmenu-spinner").addClass("personmenu-spinner-on");S=null},H.spinner_delay)}}function i(){A=false;if(S){window.clearTimeout(S);S=null}p().removeClass("personmenu-spinning");if(p().one(".personmenu-spinner")){p().one(".personmenu-spinner").removeClass("personmenu-spinner-on")}}function G(){Q=true;p().removeClass("personmenu-hidden")}function M(){Q=false;p().addClass("personmenu-hidden")}function m(U){var V,W;V=U.getXY();W=H.zeus?8:6;V[0]-=parseInt((48-U.get("width"))/2,10)+W;V[1]-=parseInt((48-U.get("height"))/2,10)+W;p().setStyle("position","absolute");p().setStyle("left",V[0]+"px");p().setStyle("top",V[1]+"px")}function D(U){var W,Y;W=R(U);Y=j(U);q(W,Y);if(H.zeus){var V=a(U);var X='<ul><li><a href="/people/'+V+'" class="personmenu-item">Profile</a></li><li><a href="'+W+'" class="personmenu-item">Photostream</a></li><li class="personmenu-sep-bottom"><a href="/photos/'+V+'/favorites" class="personmenu-item">Favorites</a></li><li><a href="" class="personmenu-item personmenu-more">More...</a></li></ul>';p().one(".personmenu-bd").set("innerHTML",X);p().one(".personmenu-name").set("innerHTML",V)}}D=B(D);function P(U){var X,W,V;P.in_progress_nsids=P.in_progress_nsids||{};X=P.in_progress_nsids;W={success:function(ab,aa,Y){var Z=aa.responseText;if(Z){f(Y,Z)}if(A&&o===Y){E(Y)}},failure:function(aa,Z,Y){if(A&&o===Y){if(Z.statusText==="timeout"){e(c.transjax.get("personmenu","error_timeout"))}else{e(c.transjax.get("personmenu","error_getting"))}}},end:function(Z,Y){delete X[Y]}};V="/personmenu_fragment.gne?nsid="+U+"&magic_cookie="+c.config.flickr.magic_cookie;if(H.zeus){V=V+"&zeus=1"}if(X[U]){return false}X[U]=U;c.io(V+"&cachebust="+(new Date()).getTime(),{timeout:H.io_timeout,on:W,"arguments":U})}function E(U){var V=h(U);if(V){if(H.zeus){p().set("innerHTML",V)}else{p().one(".personmenu-bd").set("innerHTML",V)}i();var W=y.getAttribute("data-menu-id");if(W){p().set("id",W)}else{W=false}c.fire("personmenu:show",W);v()}else{s();P(U)}}function e(V){var U='<div class="alert">'+V+"</div>";p().one(".personmenu-bd").set("innerHTML",U);i();v()}function r(U){var V;U=l(U)||y;if(!U){return false}y=U;V=a(U);if(!V){return false}o=V;i();K();D(U);m(U);G();if(H.zeus&&!h(V)){P(V)}return true}function k(U){var V;U=l(U)||y;if(!U){return false}y=U;V=a(U);if(!V){return false}o=V;r(U);E(V);return true}function K(){p().addClass("personmenu-closed");p().removeClass("personmenu-open");d=false}function v(){p().removeClass("personmenu-closed");p().addClass("personmenu-open");d=true;p().one(".personmenu-bd").vis.animScrollIntoView()}c.personmenu={init:O,showClosed:r,showOpen:k,hide:M}},"0.0.1",{requires:["node","anim","anim-scroll","node-visibility","event-custom","cache-simple","io-base","personmenu-transjax","personmenu-css"],optional:["contact-changer"]});(function(){var a="flickr";YUI.add(a,function(c){function b(){c.FlickrApp.init();if(c.config.flickr.flags.enable_grease||c.config.flickr.user&&c.config.flickr.user.nsid){c.personmenu.init()}if(c.config.flickr.sharing.use_share_this_v3){c.use("share-this-v3-menu",function(e){e.shareThisV3Menu.init()});if(c.config.flickr.sharing.share_immediately_service){c.use("share-this-v3-dialog",function(e){var f=e.config.flickr.sharing.share_immediately_service;e.shareThisV3Dialog.share_by_service(f.service_id,f.service_type_id)})}}if(c.config.flickr.flags.enable_tumblr_trackr){c.use("tumblr-trackr",function(e){e.tumblrTrackr.init()})}if(c.config.flickr.flags.view_count_on_visible){c.ViewCount.onVisible("img.view-count-on-visible")}c.tooltips.init();if(window.devicePixelRatio>1&&document.cookie.indexOf("rtna=1")===-1){var d=new Date();d.setTime(d.getTime()+2592000000);document.cookie="rtna=1; expires="+d.toGMTString()+"; path=/"}if(c.config.flickr.flags.enable_sitekey_fetcher){window.setInterval(function(){if(c.config.flickrAPI&&c.config.flickrAPI.api_key){c.use("gallery-flickr-api",function(f){var h,e,g;h="flickr.site.getKey";e={};g={success:function(i){if(i&&i.data&&i.data.key&&i.data.key._content&&f.Lang.isString(i.data.key._content)){f.config.flickrAPI.api_key=i.data.key._content}},failure:function(i){}};f.flickrAPI.callMethod(h,e,g)})}},7*60*60*1000)}}c.flickr=b},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("popup-login",function(a){var e="/photo_grease_postlogin.gne",h=false,q=false,o=false,r,p="head-upload-link",c="signin-popup",l=/cookie_session=[^;]+/gi,b=a.global_dialog;function n(){var s={method:"post",data:"random=0",on:{success:function(v,u,t){if(u&&(u.responseText==="1,1"||u.responseText==="1,0")){a.fire("login:authenticated",u.responseText)}else{d()}}}};a.later(100,this,g);a.io("/fragment.gne?name=social-auth-fragment",s)}function g(){if(b){b.show({loading:true,modal:true})}}function d(){if(b){b.hide()}}function k(v){if(a.config.flickr.is_touch_device){var u=e+"?d="+window.location+"&notpopup=1";window.location=v+"?popup=0&redir="+encodeURIComponent(u);return false}var t=v+"?popup=1&redir="+e+"?d="+window.location;try{r=window.open(t,"newWindow","width=650,height=650,resizable=1,scrollbars=1,location=yes")}catch(w){return true}try{if(r.focus){r.focus()}}catch(s){}a.later(500,this,function(){if(!r||r.closed||typeof r.closed==="undefined"||!h){var x=e+"?d="+window.location+"&notpopup=1";window.location=v+"?popup=0&redir="+encodeURIComponent(x)}});return false}function i(){a.later(20,this,f);q=true;k("/signin")}var j=0;function f(){if(document.cookie.match(l)){q=false;n()}else{a.later(20,this,f)}}function m(){if(a.config.flickr.user.nsid){return}a.one("body").on("click",function(u){var t=u.target.get("id");if(u.target.ancestor("."+c,true)){u.preventDefault();u.halt();i()}else{if(t===p){o=true;u.halt();i()}}});var s=a.one("window");s.on("login|blur",function(t){h=true});s.on("login|focus",function(t){h=false;if(q){n()}});a.on("login:authenticated",function(t){if(t==="1,1"){window.location="/"}else{if(o){window.location="/photos/upload"}else{window.location.reload()}}})}a.popup_login={init:m}},"0.0.1",{requires:["node","event","io-base"]});YUI.add("liquid-resizer",function(b){function a(c){b.on("resize",b.betterThrottle(function(){var d=F.liquid.resizePage(true);b.fire("Liquid:resize",d)},20))}b.liquidResizer={init:a}},"0.0.1",{requires:F.config.modules["liquid-resizer"].requires||[],optional:F.config.modules["liquid-resizer"].optional||[]});/*
YUI 3.7.3 (build 5687)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("json-stringify",function(e,t){function n(t){var n=typeof global=="object"?global:undefined;return(e.UA.nodejs&&n?n:e.config.win||{})[t]}function B(e){var t=typeof e;return y[t]||y[a.call(e)]||(t===h?e?h:p:c)}function j(e){return D[e]||(D[e]="\\u"+("0000"+(+e.charCodeAt(0)).toString(16)).slice(-4),P[e]=0),++P[e]===H&&(M.push([new RegExp(e,"g"),D[e]]),_=M.length),D[e]}function F(e){var t,n;for(t=0;t<_;t++)n=M[t],e=e.replace(n[0],n[1]);return A+e.replace(O,j)+A}function I(e,t){return e.replace(/^/gm,t)}function q(t,n,r){function M(e,t){var a=e[t],f=B(a),y=[],A=r?L:k,O,_,D,P,H;o(a)&&s(a.toJSON)?a=a.toJSON(t):f===g&&(a=l(a)),s(i)&&(a=i.call(e,t,a)),a!==e[t]&&(f=B(a));switch(f){case g:case h:break;case d:return F(a);case v:return isFinite(a)?a+b:p;case m:return a+b;case p:return p;default:return undefined}for(_=c.length-1;_>=0;--_)if(c[_]===a)throw new Error("JSON.stringify. Cyclical reference");O=u(a),c.push(a);if(O)for(_=a.length-1;_>=0;--_)y[_]=M(a,_)||p;else{D=n||a,_=0;for(P in D)D.hasOwnProperty(P)&&(H=M(a,P),H&&(y[_++]=F(P)+A+H))}return c.pop(),r&&y.length?O?S+C+I(y.join(N),r)+C+x:w+C+I(y.join(N),r)+C+E:O?S+y.join(T)+x:w+y.join(T)+E}if(t===undefined)return undefined;var i=s(n)?n:null,f=a.call(r).match(/String|Number/)||[],l=e.JSON.dateToString,c=[],y,A,O;P={},H=e.JSON.charCacheThreshold;if(i||!u(n))n=undefined;if(n){y={};for(A=0,O=n.length;A<O;++A)y[n[A]]=!0;n=y}return r=f[0]==="Number"?(new Array(Math.min(Math.max(0,r),10)+1)).join(" "):(r||b).slice(0,10),M({"":t},"")}var r=n("JSON"),i=e.Lang,s=i.isFunction,o=i.isObject,u=i.isArray,a=Object.prototype.toString,f=a.call(r)==="[object JSON]"&&r,l=!!f,c="undefined",h="object",p="null",d="string",v="number",m="boolean",g="date",y={"undefined":c,string:d,"[object String]":d,number:v,"[object Number]":v,"boolean":m,"[object Boolean]":m,"[object Date]":g,"[object RegExp]":h},b="",w="{",E="}",S="[",x="]",T=",",N=",\n",C="\n",k=":",L=": ",A='"',O=/[\x00-\x07\x0b\x0e-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,M=[[/\\/g,"\\\\"],[/\"/g,'\\"'],[/\x08/g,"\\b"],[/\x09/g,"\\t"],[/\x0a/g,"\\n"],[/\x0c/g,"\\f"],[/\x0d/g,"\\r"]],_=M.length,D={},P,H;if(f)try{l="0"===f.stringify(0)}catch(R){l=!1}e.mix(e.namespace("JSON"),{useNativeStringify:l,dateToString:function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+k+t(e.getUTCMinutes())+k+t(e.getUTCSeconds())+"Z"},stringify:function(t,n,r){return f&&e.JSON.useNativeStringify?f.stringify(t,n,r):q(t,n,r)},charCacheThreshold:100})},"3.7.3",{requires:["yui-base"]});
YUI.add("gallery-storage-lite",function(b){var s=b.config.doc,j=b.config.win,c=b.JSON,r=b.namespace("StorageLite"),i="yui_storage_lite",v="YUI StorageLite data",y=1048576,p="1.0",t="ready",x=0,h=1,a=2,m=3,k=4,f="yui_storage_lite",l="data",u={},n,g;try{if(j.localStorage){g=h}else{if(j.globalStorage){g=a;var o=j.globalStorage[j.location.hostname]}else{if(j.openDatabase&&navigator.userAgent.indexOf("Chrome")===-1){g=m}else{if(b.UA.ie>=5){g=k}else{g=x}}}}}catch(q){g=x}b.StorageFullError=function(d){b.StorageFullError.superclass.constructor.call(d);this.name="StorageFullError";this.message=d||"Maximum storage capacity reached";if(b.UA.ie){this.description=this.message}};b.extend(b.StorageFullError,Error);b.augment(r,b.EventTarget,true,null,{emitFacade:true,prefix:"storage-lite",preventable:false});r.publish(t,{fireOnce:true});b.mix(r,{clear:function(){},getItem:function(e,d){return null},length:function(){return 0},removeItem:function(d){},setItem:function(d,e){}});if(g===h||g===a){b.mix(r,{length:function(){return n.length},removeItem:function(d){n.removeItem(d)},setItem:function(e,w,d){n.setItem(e,d?c.stringify(w):w)}},true);if(g===h){n=j.localStorage;b.mix(r,{clear:function(){n.clear()},getItem:function(w,e){try{return e?c.parse(n.getItem(w)):n.getItem(w)}catch(d){return null}}},true)}else{if(g===a){n=j.globalStorage[j.location.hostname];b.mix(r,{clear:function(){for(var d in n){if(n.hasOwnProperty(d)){n.removeItem(d);delete n[d]}}},getItem:function(w,e){try{return e?c.parse(n[w].value):n[w].value}catch(d){return null}}},true)}}r.fire(t)}else{if(g===m||g===k){b.mix(r,{clear:function(){u={};r._save()},getItem:function(e,d){return u.hasOwnProperty(e)?u[e]:null},length:function(){var e=0,d;for(d in u){if(u.hasOwnProperty(d)){e+=1}}return e},removeItem:function(d){if(u){delete u[d];r._save()}else{u={}}},setItem:function(e,w,d){u[e]=w;r._save()}},true);if(g===m){n=j.openDatabase(i,p,v,y);b.mix(r,{_save:function(){n.transaction(function(d){d.executeSql("REPLACE INTO "+i+" (name, value) VALUES ('data', ?)",[c.stringify(u)])})}},true);n.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS "+i+"(name TEXT PRIMARY KEY, value TEXT NOT NULL)");d.executeSql("SELECT value FROM "+i+" WHERE name = 'data'",[],function(z,w){if(w.rows.length){try{u=c.parse(w.rows.item(0).value)}catch(e){u={}}}r.fire(t)})})}else{if(g===k){n=s.createElement("span");n.addBehavior("#default#userData");b.mix(r,{_save:function(){var e=c.stringify(u);try{n.setAttribute(l,e);n.save(f)}catch(d){throw new b.StorageFullError()}}},true);b.on("domready",function(){s.body.appendChild(n);n.load(f);try{u=c.parse(n.getAttribute(l))}catch(d){u={}}r.fire(t)})}}}else{r.fire(t)}}},"1.0.0",{requires:["event-base","event-custom","event-custom-complex","json"]});YUI.add("occult",function(e){if(typeof window.FLICKR==="undefined"){window.FLICKR={};var d=window.FLICKR}function c(){var f=arguments,l=null,h,g,k;for(h=0;h<f.length;h=h+1){k=(""+f[h]).split(".");l=FLICKR;for(g=(k[0]=="FLICKR")?1:0;g<k.length;g=g+1){l[k[g]]=l[k[g]]||{};l=l[k[g]]}}return l}function b(h,l){c(h);var g=h.split("."),f=g.length,k=FLICKR;for(var j=0;j<g.length-1;j++){k=k[g[j]]}k[g[f-1]]=l}function a(f,g){return d[f]}e.occult={register:b,get:a}},"0.0.1",{});YUI.add("photo-transjax",function(a){a.transjax.add("photo",{your_favorites:'Your favorites',untitled:'Untitled',window_title:'%s | Flickr - Photo Sharing!'})},"0.0.1",{requires:["transjax-base"]});(function(){var a="type-cast";YUI.add(a,function(h){function e(i){if(h.Lang.isNumber(i)){i=i+""}return h.Lang.isString(i)?i:""}function c(i){if(i==="0"){i=0}return !!i}function d(i){i=parseInt(i,10);if(!h.Lang.isNumber(i)){return undefined}return i}function f(i){i=d(i);if(!h.Lang.isNumber(i)||i<0||i>3){return undefined}return i}function b(i){return h.Lang.isArray(i)?i:[]}function g(i){return h.Lang.isObject(i)?i:{}}h.TypeCast={string:e,bool:c,integer:d,integer0123:f,arr:b,obj:g}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());(function(){var a="urls";YUI.add(a,function(b){var h={photo:/^\/photos\/([^\/]+)\/(\d+)(?:\/in\/([^\/]+))?(?:(?:\/page(\d+))|(?:\/(lightbox))|(?:\/(tour)))?/,photostream:/^\/photos\/([^\/]+)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?/,delete_photo:/^\/photos\/([^\/]+)\/?\?delete=(\d+)(?:&context=([^&]+))?/,faves:/^\/photos\/([^\/]+)\/favorites(?:\/from\/([^\/]+))?(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,explore:/^\/explore\/?(\d{4}\/\d{2}\/\d{2})?(?:\/?with\/([0-9]+))?\/?(lightbox\/?)?/,group_pool:/^\/groups\/([^\/]+)\/?(?:pool)?(?:\/((?:(?!with|page|lightbox)[^\/\?])+))?(?:\/with\/(\d+))?(?:\/page(\d+))?(\/lightbox)?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,gallery:/^\/photos\/([^\/]+)\/galleries\/([0-9]+)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?/,contacts:/^\/photos\/(?:friends|contacts)(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/,contactsfaves:/^\/photos\/contacts\/favorites(?:\/page(\d+))?(?:\/with\/(\d+))?(?:\/(lightbox))?\/?(?:\?(?:[^&]*&)?view=([^&]+))?/};function e(r,t){var q,s={};if(!h[r]){b.log('[urls] no regex found for page_type "'+r+'"');return}q=h[r].exec(t);switch(r){case"photo":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.photo_id=q[2];s.context_id=q[3]&&decodeURIComponent(q[3]);s.page=q[4];s.lightbox=q[5]?true:false;s.tour=q[6]?true:false;break;case"photostream":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.page=q[2];s.photo_id=q[3];s.lightbox=q[4]?true:false;break;case"delete_photo":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.photo_id=q[2];s.context_id=q[3];break;case"faves":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.from=q[2]&&decodeURIComponent(q[2]);s.page=q[3];s.photo_id=q[4];s.lightbox=q[5]?true:false;s.view_mode=q[6];break;case"group_pool":s.group_id=q[1]&&decodeURIComponent(q[1]);s.owner_id=q[2]&&decodeURIComponent(q[2]);s.photo_id=q[3];s.page=q[4];s.lightbox=q[5]?true:false;s.view_mode=q[6];break;case"gallery":s.path_alias=q[1]&&decodeURIComponent(q[1]);s.gallery_id=q[2]&&decodeURIComponent(q[2]);s.page=q[3];s.photo_id=q[4];s.lightbox=q[5]?true:false;break;case"contacts":s.page=q[1];s.photo_id=q[2];s.lightbox=q[3]?true:false;s.view_mode=q[4];break;case"contactsfaves":s.page=q[1];s.photo_id=q[2];s.lightbox=q[3]?true:false;s.view_mode=q[4];break;case"explore":s.date=q[1];s.photo_id=q[2];s.lightbox=q[3]}return s}function c(s,r){var q;r=r||{};if(r.photo&&b.Lang.isString(r.photo)){r.photo_id=r.photo;if(b.PhotoData){r.photo=b.PhotoData.get(r.photo)}if(!b.Lang.isObject(r.photo)){r.photo=undefined;delete r.photo}}if(b.Lang.isObject(r.photo)){r.photo_id=r.photo.get("id")}switch(s){case"photo":q=p(r);break;case"photostream":q=l(r);break;case"delete_photo":q=o(r);break;case"faves":q=n(r);break;case"group_pool":q=i(r);break;case"gallery":q=d(r);break;case"contacts":q=m(r);break;case"contactsfaves":q=k(r);break;case"explore":q=g(r);break}return q}function p(v){var s,t,u,r,z,x,B,y,A,w,q;s=v.photo;t=v.photo_id;u=v.path_alias;if(!b.Lang.isObject(s)&&!t){b.log("[urls] missing photo object or ID");return}if(!b.Lang.isObject(s)&&!u){b.log("[urls] missing photo object or path alias");return}t=t||s.get("id");u=u||s.get("pathalias")||s.get("owner");if(v.context){if(b.Lang.isString(v.context)){r=v.context}else{if(b.Lang.isObject(v.context)&&b.Lang.isString(v.context.id)){r=v.context.id}}}if(v.page){z=parseInt(v.page,10);if(z===1||!b.Lang.isNumber(z)){z=false}}x=b.Lang.isBoolean(v.lightbox)?v.lightbox:false;B=(b.Lang.isBoolean(v.sizes)||b.Lang.isString(v.sizes))?v.sizes:false;y=b.Lang.isString(v.hash)?v.hash:false;A=b.Lang.isBoolean(v.exif)?v.exif:false;w=b.Lang.isBoolean(v.faves)?v.faves:false;q=b.Lang.isBoolean(v.details)?v.details:false;return"/photos/"+u+"/"+t+"/"+(B?"sizes/"+(b.Lang.isString(B)?B+"/":""):"")+(A?"meta/":"")+(w?"favorites/":"")+(q?"edit-details/":"")+(r?("in/"+r+"/"):"")+(z?"page"+z+"/":"")+(x?"lightbox/":"")+(y?"#"+y:"")}function l(r){var s,q;if(r.photo){r.path_alias=r.photo.get("pathalias")||r.photo.get("owner")}s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}q="/photos/"+s+"/";if(r.person){q+="people/"+r.person+"/"}else{if(r.tag){if(b.Lang.isArray(r.tag)){r.tag=r.tag.join(",")}q+="tags/"+r.tag+"/"}else{if(r.photo_id){q+="with/"+r.photo_id+"/"}}}if(r.lightbox){q+="lightbox/"}return q}function o(r){var s,q;s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}photo_id=r.photo_id;if(!photo_id){b.log("[urls] missing photo_id");return}context_id=r.context_id;q="/photos/"+s+"/?delete="+photo_id+(context_id?"&context="+context_id:"")+"&magic_cookie="+b.config.flickr.magic_cookie;return q}function n(r){var s,q;s=r.path_alias;if(!s){b.log("[urls] missing path_alias");return}q="/photos/"+s+"/favorites/";if(r.from){q+="from/"+r.from+"/"}if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function i(r){var s,q;s=r.group_id;if(!s){b.log("[urls] missing group_id");return}q="/groups/"+s+"/pool/";if(r.owner_id){q+=r.owner_id+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.page){q+="page"+r.page+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function m(r){var q;q="/photos/friends/";if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function k(r){var q;q="/photos/contacts/favorites/";if(r.page){q+="page"+r.page+"/"}if(r.photo_id){q+="with/"+r.photo_id+"/"}if(r.lightbox){q+="lightbox/"}if(r.view_mode){q+="?view="+r.view_mode}return q}function d(s){var t,q,r;t=s.path_alias;q=s.gallery_id;if(!t){b.log("[urls] missing path_alias");return}if(!q){b.log("[urls] missing gallery_id");return}r="/photos/"+t+"/galleries/"+q+"/";if(s.photo_id){r+="with/"+s.photo_id+"/"}if(s.lightbox){r+="lightbox/"}return r}function g(s){var r,t,q;r=s.date;t=s.with_id;q="/explore";if(r){q+="/"+r}if(t){q+="/with/"+t}if(s.lightbox){q+="lightbox/"}return q}function j(r){if(!b.Lang.isNumber(r)){r=parseInt(r,10)}var q="",t="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var u=r,s;while(r>=58){u=r/58;s=r-(58*Math.floor(u));q=""+t.substr(s,1)+q;r=Math.floor(u)}return(u)?""+t.substr(u,1)+q:q}function f(v){var u="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var r=v.length;var q=0;var t=1;for(var s=(r-1);s>=0;s--){q=q+t*u.indexOf(v[s]);t=t*u.length}return q}b.urls={get:c,parse:e,getShortID:j,getLongID:f,regexes:h}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());(function(){var a="grease";YUI.add(a,function(d){var V=false,Q,aj,N=d.StorageLite,R=false,s,t,y,O,U,C="pc",u="pf",g="pct",P="ps",W="ps3",j="pp",q="pps",X="/photo_grease_postlogin.gne",x="fave",ab="contact",ac="share",D="share_v3",h="comment",e=/cookie_session=[^;]+/gi,l=";",al=3,M=1000,J=[C,P,W,u,g,u,j,q];if(d.config.flickr.flags.enable_grease){V=true}O=d.global_dialog;function p(){d.Array.each(J,function(Y){N.removeItem(Y)})}var af=(function(){var Y=null,aw=false,ao=0,aq=false,ap=false;function au(){M=(M>=10000)?M:M*2;return M}function av(){if(ap){if(Y){O.remove_existing_dialog();Y.cancel();aw=false}ap=false}}function ar(){ap=false;if(Y){Y.cancel()}av();O.remove_existing_dialog();aw=false;Y=null;aq=false;ao=0;M=1000;aq=false}function an(){if(Y){Y.cancel()}aq=true;d.fire("grease:cancel")}function at(){if(aq){return}if(Y){Y.cancel();Y=null}var ax={method:"post",data:"random=0",on:{success:function(aA,az,ay){if(az&&az.responseText.substring(0,1)==="1"){d.fire("grease:authenticated")}else{if(ao++<al){m();if(!Y){Y=d.later(au(),this,at)}}}},failure:function(){if(ao++<1){if(!Y){Y=d.later(au(),this,at)}}}}};d.io("/fragment.gne?name=social-auth-fragment",ax)}return{start:function(){if(!ap){ap=true;at()}else{M=50;Y&&Y.cancel();at();return}},stop:av,cancel:an,pause:function(){Y&&Y.cancel();M=1000000},canceled:aq,reset:ar}}());function ad(Y){if(!V){return}if(Y&&d.config.flickr.user.nsid){N.on("storage-lite:ready",function(){var ao=ae(C),ay=ae(u),aq=ae(g),au=ae(P,true),at=ae(W,true),an=ae(j),ax=ae(q);if(ao){y="comment";var aw=ao.indexOf(";"),ap=ao.substring(0,aw),av=ao.substring(aw+1);if(ap===d.photo.getCurrentPhoto().get("id")){Z(av)}}else{if(ay){y="fave";T(ay)}else{if(aq){y="contact";o(aq)}else{if(au){y="share";G(au)}else{if(at){y="sharev3";ah(at)}else{var ar=d.one("#global-dialog-background");if(ar){ar.setStyle("display","none")}p()}}}}}})}else{N.on("storage-lite:ready",function(){p()})}}function c(){d.detach("grease|*");Q=false;m();U(false);af.reset()}function f(Y){if(Y.target.hasClass("close-x")||Y.target.hasClass("Butt")){Y.preventDefault();Y.halt();d.global_dialog.hide()}}function z(){O.show({loading:true,modal:true})}function m(){O.hide()}function ai(an){var ao=d.one("body");var Y=ao.create('<img height="1" width="1" src="'+an+'">');ao.appendChild(Y)}function H(){O.create_dialog(d.one("#grease-confirm-"+y).get("innerHTML"),{width:355}).show({loading:false,modal:true});d.one("#global_dialog").on("click",f,this);d.later(10000,this,d.global_dialog.hide);if(d.config.flickr.flags.enable_rapid_tracking&&d.one("#reg-tour")){d.use("rapid-tracker",function(an){an.rapidTracker.addModules("grease-conversion-tracker");an.rapidTracker.beaconClick("grease-conversion-tracker",y);switch(y){case x:ai("https://pclick.internal.yahoo.com/p/s=2143640346&t="+Math.random());break;case ab:ai("https://pclick.internal.yahoo.com/p/s=2143640345&t="+Math.random());break;case ac:ai("https://pclick.internal.yahoo.com/p/s=2143640344&t="+Math.random());break;default:ai("https://pclick.internal.yahoo.com/p/s=2143640343&t="+Math.random())}})}}function T(Y){if(d.photo&&d.photo.getCurrentPhoto&&d.photo.getCurrentPhoto().get("is_owner")){O.remove_existing_dialog();var an=d.one("#global-dialog-background");if(an){an.setStyle("display","none")}p();return}H();if(!d.PhotoData.get(Y).get("is_fave")){d.PhotoData.get(Y).toggle_fave()}p()}function G(Y){z();p();d.flickrAPI.callMethod("flickr.sharing.share",Y,{success:function(an){m();H()},failure:r})}function ah(Y){z();p();Y.magic_cookie=d.config.flickr.magic_cookie;Y.from_grease=1;d.use("share-this-v3-dialog",function(an){an.shareThisV3Dialog.do_share_action(Y)})}function r(){p();O.create_dialog(d.one("#grease-error").get("innerHTML")).show({loading:false,modal:true,width:355,style:"grease-error"});d.one("#global_dialog").on("click",f,this);d.later(5000,this,d.global_dialog.hide)}function o(Y){z();contactArr=Y.split(";");d.flickrAPI.callMethod("flickr.contacts.add",{user_id:contactArr[0],friend:contactArr[1],family:contactArr[2]},{success:function(an){m();H();p()},failure:r})}function n(){if(document.cookie.match(e)){Q=false;z();checkAuth()}else{d.later(20,this,n)}}function Z(ao){z();p();var an=d.one("#message");if(!an){r();return}d.one("#message").set("innerHTML",ao);var Y={method:"post",data:"preview=0",form:{id:d.one(".add-comment-form form")},on:{success:function(au,at,aq){m();H();var ap=d.one("#comments");ap.set("innerHTML",at.responseText);var ar=ap.one(".Problem");if(ar){O.create_alert_dialog(ar.get("innerHTML"),function(){ap.one("#message").scrollIntoView()})}}}};d.io("/photo_comments_fragment.gne",Y)}function A(ap){var ao;af.reset();var an=ap+"&popup=1&redir="+X+"?d="+encodeURIComponent(window.location+"?reg=1")+"&src="+y;if(d.config.flickr.is_touch_device){ao=X+"?d="+window.location+"&notpopup=1&src="+y+"&reg=1";window.location=ap+"&popup=0&redir="+encodeURIComponent(ao);return false}try{aj=window.open(an,"newWindow","width=650,height=650,resizable=1,scrollbars=1,location=yes")}catch(ar){return true}try{if(aj.focus){aj.focus()}}catch(Y){}if(!aj||aj.closed||typeof aj.closed==="undefined"){ao=X+"?d="+window.location+"&notpopup=1&src="+y+"&reg=1";window.location=ap+"&popup=0&redir="+encodeURIComponent(ao)}var aq=d.one("window");aq.on("grease|focus",function(){if(!af.canceled){af.start()}if(!document.cookie.match(e)){m();U(false);n()}});d.on("grease:cancel",function(at){Q=false;c()});aq.on("grease|blur",function(){if(!af.canceled){af.pause()}});aq.on("grease:timeout",function(at){Q=false;c()});d.on("grease:authenticated",function(aw){z();Q=false;U(true);var ax=(W),at=["reg=1","src="+y];if(ax){var av=window.location.toString(),au=av.match(/\?/i);av+=(!au?"?":"&")+at.join("&");window.location=av}else{window.location=d.urls.get("photo",{photo:d.photo.getCurrentPhoto()})+"?"+at.join("&")}});return false}function b(ao,ap,an){var Y=an||false;N.setItem(ao,ap,Y)}function ae(Y,ao){var an=ao||false;return N.getItem(Y,an)}function E(Y){if(!Q){af.reset();U=Y||function(){};d.global_dialog.remove_existing_dialog();d.global_dialog.show({loading:true,modal:true});Q=true;A("/signin?src="+y+"&reg=1")}else{c();E(Y)}}function K(Y){p();b(C,d.photo.getCurrentPhoto().get("id")+l+Y);y="comment"}function w(Y){p();b(u,Y);y="fave"}function aa(Y){p();if(d.Lang.isArray(Y)){b(g,Y.join(";"));y="contact"}}function S(Y){p();b(P,Y,true);y="share"}function ag(Y){p();b(W,Y,true);y="sharev3"}function v(Y){p();b(j,Y);y="party"}function am(Y){p();b(q,d.JSON.stringify(Y));y="partyStart"}d.grease={init:ad,enabled:V,authenticate:E,postComment:K,addFave:w,addContact:aa,share:S,shareV3:ag,photoParty:v,photoPartyStart:am};if(d.config.flickr.user.admin_user==="saw"){d.occult.register("postComment",function(Y){Z(Y)});d.occult.register("showdialog",function(Y){y="fave";H()});d.occult.register("fakeerror",function(Y){r(Y)})}var i=d.one("#reg-tour");function k(){for(var Y=1;Y<4;Y++){ak.removeClass(I+Y)}}function L(Y){Y.preventDefault();k();d.Event.purgeElement("#reg-tour");i.addClass("hidden")}function B(Y){if(Y.test("#reg-tour")){return}if(Y.test("ol li")){k();switch(Y.get("id")){case"step-1":ak.addClass(I+1);break;case"step-2":ak.addClass(I+2);break;case"step-3":ak.addClass(I+3);break}}else{B(Y.get("parentNode"))}}if(i){var I="tour-step",ak=d.one("body");i.one(".close-x").on("click",L);i.on("mouseover",function(Y){B(Y.target)});i.on("mouseout",function(Y){k()})}},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}());YUI.add("photo-data",function(g){var b={},a=g.TypeCast;function f(i){var h;if(i instanceof d){h=i}else{if(b[i.id]){h=b[i.id];h.merge_data(i)}else{h=new d(i);b[i.id]=h}}return h}function c(h){if(typeof h==="undefined"){return b}else{return b[h]}}function e(h){return g.Lang.isNumber(h)&&parseInt(h,10)===h}g.PhotoData={add:f,get:c};function d(h){d.superclass.constructor.apply(this,arguments)}d.NAME="PhotoData";d.ATTRS={id:{value:""},title:{broadcast:1,value:"",setter:function(i,h){i=a.string(i);return i.replace(/^\s+$/,"")}},description:{broadcast:1,value:"",setter:a.string},owner:{value:"",setter:function(h){if(!g.Lang.isString(h)){if(g.Lang.isObject(h)&&h.nsid){h=h.nsid}else{h=""}}return h}},ownername:{value:""},pathalias:{value:""},url:{value:"",getter:function(i,h){return g.urls.get("photo",{photo:this})}},date_posted:{broadcast:1,getter:a.integer},is_public:{broadcast:1,getter:a.bool},is_friend:{broadcast:1,getter:a.bool},is_family:{broadcast:1,getter:a.bool},perm_comment:{broadcast:1,getter:a.integer0123},perm_addmeta:{broadcast:1,getter:a.integer0123},perms:{getter:function(){return{is_public:this.get("is_public"),is_friend:this.get("is_friend"),is_family:this.get("is_family"),perm_comment:this.get("perm_comment"),perm_addmeta:this.get("perm_addmeta")}}},license:{broadcast:1,getter:a.integer,setter:a.integer},safety_level:{broadcast:1,getter:a.integer,setter:a.integer},needs_interstitial:{broadcast:1,value:false,getter:a.bool,setter:a.bool},media:{broadcast:1,value:"photo"},is_video:{getter:function(){return(this.get("media")==="video")}},secret:{value:""},deleted:{value:false},dmca_takedown:{value:false},geo:{broadcast:1,getter:function(h){if(!g.Lang.isObject(h)){h={}}return h}},has_geo:{getter:function(){var h=this.get("geo");return(h&&h.latitude&&h.longitude&&h.accuracy)}},exif_latlong:{},perm_viewgeo:{broadcast:1,value:false},is_bad:{broadcast:1,getter:a.integer,setter:a.integer},content_type:{broadcast:1,getter:a.integer,setter:a.integer},is_fave:{broadcast:1,value:false,setter:function(j,h){j=a.bool(j);var i=this.get(h);if(j!==i){if(j){this.increment("fave_count")}else{this.decrement("fave_count")}}if(this.get("fave_changes_pending")===0){this.set("is_confirmed_fave",j)}return j},getter:a.bool},is_confirmed_fave:{value:undefined},fave_changes_pending:{value:0},fave_count:{broadcast:1,value:0,getter:a.integer,setter:a.integer},comment_count:{broadcast:1,value:0,getter:a.integer,setter:a.integer},can_addmeta:{value:false,getter:a.bool},can_comment:{value:false,getter:a.bool},can_fave:{value:false,getter:function(){if(this.get("is_ignored")){return false}if(this.get("dmca_takedown")){return false}if(this.get("is_owner")){return false}if(!g.config.flickr.user.nsid&&!g.config.flickr.flags.enable_grease){return false}return true}},group_count:{broadcast:1,getter:a.integer,setter:a.integer},people_count:{broadcast:1,getter:a.integer,setter:a.integer},guestpass_count:{broadcast:1,getter:a.integer,setter:a.integer},is_owner:{value:false,getter:function(){return g.config.flickr.user.nsid&&g.config.flickr.user.nsid===this.get("owner")}},is_ignored:{value:false},tags:{broadcast:1,getter:a.arr},sizes:{value:{},getter:function(m,i){var j,l,h,k;m=a.obj(m);if(g.config.flickr.flags.enable_2048_images){j=m.o||m.l||m.z;if(j&&(j.width>=2048||j.height>=2048)){l=j.width/j.height;if(l>1){k=2048;h=Math.round(2048/l)}else{h=2048;k=Math.round(2048*l)}m["2048"]={url:m.t.url.replace("_t","_2048"),height:h+"",width:k+"",label:"2048"}}}return m}}};g.extend(d,g.Base,{initializer:function(h){this.merge_data(h)},merge_data:function(i){var j,h;if(typeof i.id!=="undefined"&&i.id!==this.get("id")){this.set("id",i.id)}if(typeof i.title!=="undefined"&&i.title!==this.get("title")){this.set("title",i.title)}if(typeof i.description!=="undefined"&&i.description!==this.get("description")){this.set("description",i.description)}if(typeof i.owner!=="undefined"&&i.owner!==this.get("owner")){this.set("owner",i.owner)}if(typeof i.ownername!=="undefined"&&i.ownername!==this.get("ownername")){this.set("ownername",i.ownername)}if(typeof i.pathalias!=="undefined"&&i.pathalias!==this.get("pathalias")){this.set("pathalias",i.pathalias)}if(typeof i.url!=="undefined"&&i.url!==this.get("url")){this.set("url",i.url)}if(typeof i.date_posted!=="undefined"&&i.date_posted!==this.get("date_posted")){this.set("date_posted",i.date_posted)}if(typeof i.date_taken!=="undefined"&&i.date_taken!==this.get("date_taken")){this.set("date_taken",i.date_taken)}if(typeof i.is_public!=="undefined"&&i.is_public!==this.get("is_public")){this.set("is_public",i.is_public)}if(typeof i.is_friend!=="undefined"&&i.is_friend!==this.get("is_friend")){this.set("is_friend",i.is_friend)}if(typeof i.is_family!=="undefined"&&i.is_family!==this.get("is_family")){this.set("is_family",i.is_family)}if(typeof i.can_comment!=="undefined"&&i.can_comment!==this.get("can_comment")){this.set("can_comment",i.can_comment)}if(typeof i.can_addmeta!=="undefined"&&i.can_addmeta!==this.get("can_addmeta")){this.set("can_addmeta",i.can_addmeta)}if(typeof i.perm_comment!=="undefined"&&i.perm_comment!==this.get("perm_comment")){this.set("perm_comment",i.perm_comment)}if(typeof i.perm_addmeta!=="undefined"&&i.perm_addmeta!==this.get("perm_addmeta")){this.set("perm_addmeta",i.perm_addmeta)}if(typeof i.license!=="undefined"&&i.license!==this.get("license")){this.set("license",i.license)}if(typeof i.needs_interstitial!=="undefined"&&i.needs_interstitial!==this.get("needs_interstitial")){this.set("needs_interstitial",i.needs_interstitial)}if(typeof i.safety_level!=="undefined"&&i.safety_level!==this.get("safety_level")){this.set("safety_level",i.safety_level)}if(typeof i.media!=="undefined"&&i.media!==this.get("media")){this.set("media",i.media)}if(typeof i.secret!=="undefined"&&i.secret!==this.get("secret")){this.set("secret",i.secret)}if(typeof i.is_bad!=="undefined"&&i.is_bad!==this.get("is_bad")){this.set("is_bad",i.is_bad)}if(typeof i.content_type!=="undefined"&&i.content_type!==this.get("content_type")){this.set("content_type",i.content_type)}if(typeof i.is_faved!=="undefined"&&i.is_faved!==this.get("is_fave")){this.set("is_fave",i.is_faved)}if(typeof i.is_fave!=="undefined"&&i.is_fave!==this.get("is_fave")){this.set("is_fave",i.is_fave)}if(typeof i.fave_count!=="undefined"&&i.fave_count!==this.get("fave_count")){this.set("fave_count",i.fave_count)}if(typeof i.count_faves!=="undefined"&&i.count_faves!==this.get("fave_count")){this.set("fave_count",i.count_faves)}if(typeof i.comment_count!=="undefined"&&i.comment_count!==this.get("comment_count")){this.set("comment_count",i.comment_count)}if(typeof i.count_comments!=="undefined"&&i.count_comments!==this.get("comment_count")){this.set("comment_count",i.count_comments)}if(typeof i.geo!=="undefined"&&i.geo!==this.get("geo")){this.set("geo",i.geo)}if(typeof i.exif_latlong!=="undefined"&&i.exif_latlong!==this.get("exif_latlong")){this.set("exif_latlong",i.exif_latlong)}if(typeof i.perm_viewgeo!=="undefined"&&i.perm_viewgeo!==this.get("perm_viewgeo")){this.set("perm_viewgeo",i.perm_viewgeo)}if(typeof i.woe!=="undefined"&&i.woe!==this.get("woe")){this.set("woe",i.woe)}if(typeof i.tags!=="undefined"&&i.tags!==this.get("tags")){this.set("tags",i.tags)}if(typeof i.group_count!=="undefined"&&i.group_count!==this.get("group_count")){this.set("group_count",i.group_count)}if(typeof i.people_count!=="undefined"&&i.people_count!==this.get("people_count")){this.set("people_count",i.people_count)}if(typeof i.guestpass_count!=="undefined"&&i.guestpass_count!==this.get("guestpass_count")){this.set("guestpass_count",i.guestpass_count)}if(i.sizes&&g.Lang.isObject(i.sizes)){j=i.sizes}else{j={};if(i.url_sq){j.sq={url:i.url_sq,width:parseInt(i.width_sq,10),height:parseInt(i.height_sq,10)}}if(i.url_t){j.t={url:i.url_t,width:parseInt(i.width_t,10),height:parseInt(i.height_t,10)}}if(i.url_s){j.s={url:i.url_s,width:parseInt(i.width_s,10),height:parseInt(i.height_s,10)}}if(i.url_m){j.m={url:i.url_m,width:parseInt(i.width_m,10),height:parseInt(i.height_m,10)}}if(i.url_z){j.z={url:i.url_z,width:parseInt(i.width_z,10),height:parseInt(i.height_z,10)}}if(i.url_l){j.l={url:i.url_l,width:parseInt(i.width_l,10),height:parseInt(i.height_l,10)}}if(i.url_h){j.h={url:i.url_h,width:parseInt(i.width_h,10),height:parseInt(i.height_h,10)}}if(i.url_k){j.k={url:i.url_k,width:parseInt(i.width_k,10),height:parseInt(i.height_k,10)}}if(i.url_o){j.o={url:i.url_o,width:parseInt(i.width_o,10),height:parseInt(i.height_o,10)}}if(i.media==="video"){if(i.height_v){j.v={width:parseInt(i.width_v,10),height:parseInt(i.height_v,10)}}}}if(g.Object.size(j)){h=this.get("sizes")||{};g.Object.each(h,function(k,l){if(j[l]){j[l]=g.merge(k,j[l])}});this.set("sizes",g.merge(h,j))}},toggle_fave:function(){var i=this,h,l,j,k;if(!this.get("can_fave")){return}if(g.config.flickr.flags.enable_grease&&!g.config.flickr.user.nsid){g.grease.addFave(this.get("id"));g.grease.authenticate();return}h=!this.get("is_fave");l="flickr.favorites."+(h?"add":"remove");j={photo_id:this.get("id")};k={success:function(){var m,n,o,p;m=i.get("id");i.decrement("fave_changes_pending");i.set("is_confirmed_fave",h);if(i.get("fave_changes_pending")===0){i.set("is_fave",h)}n="faves-"+(g.config.flickr.user.pathalias?g.config.flickr.user.pathalias:g.config.flickr.user.nsid);o=g.ContextData.getContext(n);if(o){p=o.getPhotoPosition(m)}if(h){if(o){if(g.ContextData.getPrevLimit(n)===p){g.ContextData.unremovePhoto(n,p)}else{g.ContextData.invalidate(n)}}else{if(g.config.flickr.page_type==="photo"&&i.get("id")===g.photo.getCurrentPhoto().get("id")){g.ContextData.add({id:n,user_id:g.config.flickr.user.nsid,type:"faves",title:g.transjax.get("photo","your_favorites"),url:g.config.flickr.user.photos_url+"favorites/",photos:[{position:"0",photo:i}]})}}}else{if(o&&g.Lang.isNumber(p)){g.ContextData.removePhoto(n,p)}}},failure:function(){i.decrement("fave_changes_pending");if(i.get("fave_changes_pending")===0){i.set("is_fave",i.get("is_confirmed_fave"))}}};this.set("is_fave",h);this.increment("fave_changes_pending");g.flickrAPI.callMethod(l,j,k)},record_interstitial_clickthrough:function(){var h=this.get("owner");g.Object.each(b,function(i,j){if(i.get("owner")===h){i.set("needs_interstitial",false)}});g.flickrAPI.callMethod("flickr.people.recordInterstitialClickthrough",{user_id:h},function(){})},updateWoeAttributeByeId:function(i){var h=this;g.use("flickr-geo",function(j){j.flickrGeo.getWoeById(i,function(k){if(k.success&&j.Lang.isObject(k.woe)){h.set("woe",k.woe)}else{j.log("Unable to update WOE. Expected data was not received from the API.","error","photo-data")}},this)})},increment:function(h){if(!e(this.get(h))){return false}return this.add(h,1)},decrement:function(h){if(!e(this.get(h))){return false}return this.add(h,-1)},add:function(i,j){var k=this.get(i),h;if(!g.Lang.isNumber(k)||!g.Lang.isNumber(j)){return false}h=k+j;if(this.set(i,h)){return h}else{return false}}})},"0.0.1",{requires:F.config.modules["photo-data"].requires||[],optional:F.config.modules["photo-data"].optional||[]});function udm_(J){var I="comScore=",H=document,G=H.cookie,F="",E="indexOf",D="substring",C="length",B=2048,A,z="&ns_",y="&",x,w,v,u,t=window,s=t.encodeURIComponent||escape;if(G[E](I)+1){for(v=0,w=G.split(";"),u=w[C];v<u;v++){x=w[v][E](I),x+1&&(F=y+unescape(w[v][D](x+I[C])))}}J+=z+"_t="+ +(new Date)+z+"c="+(H.characterSet||H.defaultCharset||"")+F,J[C]>B&&J[E](y)>0&&(A=J[D](0,B-8).lastIndexOf(y),J=(J[D](0,A)+z+"cut="+s(J[D](A+1)))[D](0,B)),H.images?(x=new Image,t.ns_p||(ns_p=x),x.src=J):H.write("<","p","><",'img src="',J,'" height="1" width="1" alt="*"',"><","/p",">")}typeof _comscore=="undefined"&&(_comscore=[]),function(){var v="length",u=self,t=u.encodeURIComponent?encodeURIComponent:escape,s=".scorecardresearch.com",r=Math,q="script",p="width",o=/c2=(\d*)&/,n,m=function(D){if(!!D){var C,B=[],A,z=0,y,x,w="";for(var d in D){A=typeof D[d];if(A=="string"||A=="number"){B[B[v]]=d+"="+t(D[d]),d=="c2"?w=D[d]:d=="c1"&&(z=1)}}if(B[v]<=0||w==""){return}x=D.options||{},x.d=x.d||document;if(typeof x.url_append=="string"){y=x.url_append.replace(/&amp;/,"&").split("&");for(var d=0,c=y[v],a;d<c;d++){a=y[d].split("="),a[v]==2&&(B[B[v]]=a[0]+"="+t(a[1]))}}C=["http",x.d.URL.charAt(4)=="s"?"s://sb":"://b",s,"/p?",z?"":"c1=2&",B.join("&").replace(/&$/,"")],udm_(C.join(""))}},l=function(a){a=a||_comscore;for(var f=0,e=a[v];f<e;f++){m(a[f])}a=_comscore=[]};l(),(n=u.COMSCORE)?(n.purge=l,n.beacon=m):COMSCORE={purge:l,beacon:m}}();