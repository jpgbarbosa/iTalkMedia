<p id="notice"><%= notice %></p>

<script type="text/javascript"
                src="http://maps.googleapis.com/maps/api/js?key=AIzaSyA-Tsf0tnUxwyk6mHC9HtJPWybdcrx25Qc&sensor=true"></script>

<div class="accordion">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
        Band
      </a>
    </div>
    <div id="collapseOne" class="accordion-body collapse in">
      <div class="accordion-inner">
        <dl class="dl-horizontal">
          <dt><strong>Name:</strong></dt>
          <dd><%= @group[:name] %></dd>
          <dt><strong>Genre:</strong></dt>
          <dd>
      		  <% if @group[:genres] != nil %>
			  <%= @group[:genres].join(", ") %>
            <%else%>
              undefined
      		  <%end%>
          </dd>
          <dt><strong>Foundation Year:</strong></dt>
          <dd><%= @group[:foundation_year] %></dd>
          <% if @group[:end_year]!=""%>
            <dt><strong>End Year:</strong></dt>
            <dd><%= @group[:endYear] %></dd>
          <% end %>
          <% if @group[:placeformed] != nil %>
            <dt><strong>From:</strong></dt>
            <dd> 
              <a onclick="popupas(this)" lat="<%=@group[:placeformed][:lat]%>" lng="<%=@group[:placeformed][:lng]%>">
                <%=@group[:placeformed][:city].to_s<<", "<< @group[:placeformed][:country].to_s%>
              </a> 
            </dd>
            
          <% end %>
          </br>
          <dd><%= link_to 'LastFM Profile', @group[:lastFMURL]%></dd>
        </dl>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseMembers">
        Members
      </a>
    </div>
    <div id="collapseMembers" class="accordion-body collapse">
      <div class="accordion-inner">
          <table class="table table-striped">
            <thead>
              <tr> 
                <th>#</th>
                <th>Name</th>
              </tr>
            <thead>
            <tbody>
              <% ctr = 1 %>
			  <% if @group[:members]!=nil %>
              <% @group[:members].each do |g| %>
                <tr> 
                  <td><%=ctr%></td>
                  <td><%=g[:name]%></td>
                </tr>
                <% ctr+=1 %>
              <%end%>
			  <%end%>
            </tbody>

          </table>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
        Bio
      </a>
    </div>
    <div id="collapseTwo" class="accordion-body collapse">
      <div class="accordion-inner">
          <dd><%= @group[:bio].html_safe %></dd>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">
        Albuns
      </a>
    </div>
    <div id="collapseThree" class="accordion-body collapse">
      <div class="accordion-inner">
          <table class="table table-striped">
            <thead>
              <tr> 
                <th>#</th>
                <th>Cover</th>
                <th>Name</th>
              </tr>
            </thead>
            <tbody>
              <% ctr = 1 %>
              <% @group[:albums].each do |g| %>
                <tr>  
                  <td><%=ctr%></td>
                  <td><img width="60" height="60" src=<%=g[:cover]%> class="img-rounded"></td> <!-- Dont show to guilherme-->
                  <td><%= link_to g[:name], "/albums/"+g[:id] %></td>
                </tr>
                <% ctr+=1 %>
              <%end%>
            </tbody>

          </table>
      </div>
    </div>
  </div>

  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseNextConcerts">
        Next concerts
      </a>
    </div>
    <div id="collapseNextConcerts" class="accordion-body collapse">
      <div class="accordion-inner">
          <table class="table table-striped">
            <thead>
              <tr> 
                <th style="width:90px">Date</th>
                <th>Name</th>
                <th>Venue</th>
                <th>City</th>
                <th>Country</th>
                <th></th> <!-- map -->
              </tr>
            <thead>
            <tbody>
              <% ctr = 1 %>
              <% @group[:concerts].each do |g| %>
                <tr> 
                  <td style="width:90px"><%= g[:date] %></td>
                  <td><%= link_to g[:name], g[:songkick]  %></td>
                  <td><%= g[:venue] %></td>
                  <td><%= g[:city_name] %></td>
                  <td><%= g[:country_name] %></td>
                  <td>
                    <a onclick="popupas(this)" lat="<%=g[:lat]%>" lng="<%=g[:lng]%>">
                      map
                    </a>    
                  </td>
                </tr>
                <% ctr+=1 %>
              <%end%>
            </tbody>

          </table>
      </div>
    </div>
  </div>


</div>

 
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myModalLabel">Map</h3>
  </div>
  <div id="map_canvas" class="modal-body">
    
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>


<style type="text/css">
  #map_canvas { height: 330px; width: 100%; margin: 0px; padding: 0px }
</style>

<script type="text/javascript" charset="utf-8">


var popupas = function(id) {


  var center = new google.maps.LatLng($(id).attr('lat'),$(id).attr('lng'));
    var mapOptions = {
        center : center,
        zoom : 16,
        mapTypeId : google.maps.MapTypeId.HYBRID
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);

    var markerOptions = {
        position : new google.maps.LatLng($(id).attr('lat'),$(id).attr('lng')),
        map : map
    };

    var marker = new google.maps.Marker(markerOptions);

    $("#map_canvas").on('load',function(){
      alert("skdjfhsdjhf")
      google.maps.event.trigger(map,'resize');
      map.setCenter(new google.maps.LatLng($(id).attr('lat'),$(id).attr('lng')));
    });


    $('#myModal').modal('toggle')

}
</script



<%= link_to 'Edit', edit_group_path(@group) %> |
<%= link_to 'Back', groups_path %>
